<!DOCTYPE html>
<html>
<head>
<title>PERATURAN GUBERNUR JAWA TIMUR</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="cssHome.css">
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
</head>

<body>
    <div class="gal-container option">
        <form id="gal-action">
            <select id="uploadList" name="uploadList" onchange="showHideForm()">
                <option value="Select">
                ---Select---</option>
                <option value="Upload Per Bab">
                Upload Per BAB</option>
                <option value="Upload Per Point">
                Upload Per Point</option>
            </select>
        </form>
    </div>
    <div id="formBab1A" class="gal-container">
        <form id="dropFileForm" action="" method="post"
        onsubmit="uploadFiles(event)">
            <input type="file" name="files[]" id="fileInput"
            multiple onchange="addFiles(event)">

            <label for="fileInput" id="fileLabel"
            ondragover="verrideDefault(event); fileHover();"
            ondragenter="overrideDefault(event); fileHover();"
            ondragleave="overrideDefault(event); fileHoverEnd();"
            ondrop="overrideDefault(event); fileHoverEnd();
                    addFiles(event);">
                <i class="fa fa-download fa-5x"></i>
                <br>
                <span id="fileLabelText">
                    Choose a file or drag it here
                </span>
                <br>
                <span id="uploadStatus"></span>
            </label>
            <input type="submit" value="Upload"
            class="uploadButton">
            <input type="file" name="files[]" id="fileInput">
        </form>
    </div>
    <div id="formBab1" class="gal-container">
            <form id="dropFileForm" action="" method="post"
            onsubmit="uploadFiles(event)">
                <input type="file" name="files[]" id="fileInput"
                multiple onchange="addFiles(event)">
    
                <label for="fileInput" id="fileLabel"
                ondragover="verrideDefault(event); fileHover();"
                ondragenter="overrideDefault(event); fileHover();"
                ondragleave="overrideDefault(event); fileHoverEnd();"
                ondrop="overrideDefault(event); fileHoverEnd();
                        addFiles(event);">
                    <i class="fa fa-download fa-5x"></i>
                    <br>
                    <span id="fileLabelText">
                        Choose a file or drag it here
                    </span>
                    <br>
                    <span id="uploadStatus"></span>
                </label>
                <input type="submit" value="Upload"
                class="uploadButton">
                <input type="file" name="files[]" id="fileInput">
            </form>
        </div>
    <script>
            var dropFileForm=document.getElementById("dropFileForm");
            var fileLabelText=document.getElementById("fileLabelText");
            var uploadStatus=document.getElementById("uploadStatus");
            var fileInput=document.getElementById("fileInput");
            var droppedFiles;
            var actionForm;

            function showHideForm(){
                if(uploadList.value != "Upload Per Bab"){
                    formBab1A.style.display = "none";
                }
                else if(uploadList.value){
                    formBab1A.style.display = "block";
                }
            }

            function overrideDefault(event){
                event.preventDefault();
                event.stopPropagation();
            }

            function fileHover(){
                dropFileForm.classList.add("fileHover");
            }
            function fileHoverEnd(){
                dropFileForm.classList.remove("fileHover");
            }
            function addFiles(event){
                droppedFiles=event.target.files || event.dataTransfer.files;
                showFiles(droppedFiles);
            }
            function showFiles(files){
                if(files.length > 1){
                    fileLabelText.innerText=files.length + " files selected";
                }
                else{
                    fileLabelText.innerText=files[0].name;
                }
            }
            function uploadFiles(event){
                event.preventDefault();
                changeStatus("Uploading. . .");

                var formData=new FormData();

                for(var i=0,file; file=droppedFiles[i]; i++){
                    formData.append(fileInput.name,file,file.name);
                }

                var xhr=new XMLHttpRequest();
                xhr.onreadystatechange=function(data){
                    //untuk menangani respon server dan mengubah status
                    //process unggahan melalui changeStatus(text)
                }
                xhr.open(dropFileForm.method,dropFileForm.action,true);
                xhr.send(formData);
            }
            function changeStatus(text){
                uploadStatus.innerText=text;
            }
        </script>
</body>
</html>